<!DOCTYPE html>
<!-- This site was created with Hugo Blox. https://hugoblox.com -->
<!-- Last Published: July 9, 2024 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Hugo Blox Builder 5.9.6" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css" integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css" integrity="" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.32e2e32cf1a4c1ea152e519f8b1fda79.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  






<script async src="https://www.googletagmanager.com/gtag/js?id=G-W3H05TPMFN"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'G-W3H05TPMFN', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>
























  
  
  






  <meta name="author" content="Davut Ayan" />





  

<meta name="description" content="This project is a R `Shiny` Web Application that uses `Stupid Back-off` N-gram models, a `Large Language Model`, to predict next words given input text." />



<link rel="alternate" hreflang="en-us" href="https://davutemrah.github.io/post/2020-02-04-nextword/nextword_2022_02_04/" />
<link rel="canonical" href="https://davutemrah.github.io/post/2020-02-04-nextword/nextword_2022_02_04/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hu6152fefe63ed452fcffb31cfaea69f6e_14112_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hu6152fefe63ed452fcffb31cfaea69f6e_14112_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#1565c0" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@GetResearchDev" />
  <meta property="twitter:creator" content="@GetResearchDev" />
<meta property="twitter:image" content="https://davutemrah.github.io/media/icon_hu6152fefe63ed452fcffb31cfaea69f6e_14112_512x512_fill_lanczos_center_3.png" />



  

<meta property="og:type" content="article" />
<meta property="og:site_name" content="" />
<meta property="og:url" content="https://davutemrah.github.io/post/2020-02-04-nextword/nextword_2022_02_04/" />
<meta property="og:title" content="Next Word Prediction | " />
<meta property="og:description" content="This project is a R `Shiny` Web Application that uses `Stupid Back-off` N-gram models, a `Large Language Model`, to predict next words given input text." /><meta property="og:image" content="https://davutemrah.github.io/media/icon_hu6152fefe63ed452fcffb31cfaea69f6e_14112_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2022-02-04T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2024-06-28T00:00:00&#43;00:00">
  






    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://davutemrah.github.io/post/2020-02-04-nextword/nextword_2022_02_04/"
  },
  "headline": "Next Word Prediction",
  
  "datePublished": "2022-02-04T00:00:00Z",
  "dateModified": "2024-06-28T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Davut Ayan"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "",
    "logo": {
      "@type": "ImageObject",
      "url": "https://davutemrah.github.io/media/icon_hu6152fefe63ed452fcffb31cfaea69f6e_14112_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "This project is a R `Shiny` Web Application that uses `Stupid Back-off` N-gram models, a `Large Language Model`, to predict next words given input text."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Next Word Prediction | </title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="2c6006bf102cab9779a97ff8827c78df" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.3a6bdbdff5d8a89d6e651adb3deec035.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/"></a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/"></a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/notebooks/"><span>Collections</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/static/uploads/resume.pdf"><span>CV</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>Light</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>Dark</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>Automatic</span>
            </a>
          </div>
        </li>
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article">

  













  

  
  
  
<div class="article-container pt-3">
  <h1>Next Word Prediction</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Jun 28, 2024
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/llm/">LLM</a></span>
  

</div>

    




<div class="btn-links mb-3">
  
  








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://github.com/davutemrah/NextWordPrediction" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>Repo</a>

  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header" href="https://davutemrah.github.io/NextWordPrediction/#1" target="_blank" rel="noopener">
    <i class="fab fa-none mr-1"></i>Slides</a>


</div>


  
</div>



  <div class="article-container">

    <div class="article-style">
      <p>(nextword.html)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">knitr</span><span class="o">::</span><span class="n">opts_chunk</span><span class="o">$</span><span class="nf">set</span><span class="p">(</span><span class="n">cache.path</span> <span class="o">=</span> <span class="s">&#34;./cache&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">knitr</span><span class="o">::</span><span class="n">opts_chunk</span><span class="o">$</span><span class="nf">set</span><span class="p">(</span><span class="n">cache</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">rm</span><span class="p">(</span><span class="n">list</span><span class="o">=</span><span class="nf">ls</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidytext</span><span class="p">)</span>  <span class="c1"># tokenization</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">stringi</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">dtplyr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">wordcloud</span><span class="p">)</span>
</span></span></code></pre></div><h2 id="project-what-is-the-next-word">Project: What is the next word?</h2>
<h3 id="introduction">Introduction</h3>
<p>In this capstone project, we are given three sources of text such as twitter, blog and news written in English. We are expected to build a statistical model making  text predictions given one or more texts/words.</p>
<p>I will start my project reading the data and explore some insights.</p>
<h3 id="data">Data</h3>
<p>We have three sources of data. Following code will download and unzip the file.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">url</span> <span class="o">&lt;-</span> <span class="s">&#34;https://d396qusza40orc.cloudfront.net/dsscapstone/dataset/Coursera-SwiftKey.zip&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="nf">file.exists</span><span class="p">(</span><span class="s">&#34;./data&#34;</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">  <span class="nf">dir.create</span><span class="p">(</span><span class="s">&#34;./data&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">download.file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">destfile</span><span class="o">=</span><span class="s">&#34;./data/Coursera-SwiftKey.zip&#34;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s">&#34;wb&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="nf">unzip</span><span class="p">(</span><span class="n">zipfile</span><span class="o">=</span><span class="s">&#34;./data/Coursera-SwiftKey.zip&#34;</span><span class="p">,</span> <span class="n">exdir</span><span class="o">=</span><span class="s">&#34;./data&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="load-data">Load Data</h3>
<p>Here is a function to read the raw data</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">read_raw_text</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">output</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">con</span> <span class="o">&lt;-</span> <span class="nf">file</span><span class="p">(</span><span class="n">input</span><span class="p">,</span> <span class="n">open</span> <span class="o">=</span> <span class="s">&#34;r&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">&lt;-</span> <span class="nf">readLines</span><span class="p">(</span><span class="n">con</span> <span class="o">=</span> <span class="n">con</span><span class="p">,</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s">&#34;UTF-8&#34;</span><span class="p">,</span> <span class="n">skipNul</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">close</span><span class="p">(</span><span class="n">con</span> <span class="o">=</span> <span class="n">con</span><span class="p">)</span> <span class="c1"># closing connection is important</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Twitter data</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">twitter</span> <span class="o">&lt;-</span> <span class="nf">read_raw_text</span><span class="p">(</span><span class="s">&#34;data/final/en_US/en_US.twitter.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#stri_stats_general(twitter) # basic info</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">twitter</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;US_twitter data has&#34;</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">twitter</span><span class="p">),</span> <span class="s">&#34;lines&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Size of the twitter file is about&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">      <span class="nf">round</span><span class="p">(</span><span class="nf">object.size</span><span class="p">(</span><span class="n">twitter</span><span class="p">)</span><span class="o">/</span><span class="m">1024</span><span class="n">^2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="s">&#34;MB&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Longest line has&#34;</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="nf">str_length</span><span class="p">(</span><span class="n">twitter</span><span class="p">)),</span> <span class="s">&#34;characters&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Blogs Data</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">blog</span> <span class="o">&lt;-</span> <span class="nf">read_raw_text</span><span class="p">(</span><span class="s">&#34;data/final/en_US/en_US.blogs.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#stri_stats_general(blog) # basic info</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">blog</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span></code></pre></div><p>As seen above, there seems to be more words in blog data, than twitter data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;US_blogs data has&#34;</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">blog</span><span class="p">),</span> <span class="s">&#34;lines&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;size of the blogs file is about&#34;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="nf">object.size</span><span class="p">(</span><span class="n">blog</span><span class="p">)</span><span class="o">/</span><span class="m">1024</span><span class="n">^2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="s">&#34;MB&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Longest line has&#34;</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="nf">str_length</span><span class="p">(</span><span class="n">blog</span><span class="p">)),</span> <span class="s">&#34;characters&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>News Data</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">news</span> <span class="o">&lt;-</span> <span class="nf">read_raw_text</span><span class="p">(</span><span class="s">&#34;data/final/en_US/en_US.news.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#stri_stats_general(news) # basic info</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">news</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;US_news data has&#34;</span><span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="n">news</span><span class="p">),</span> <span class="s">&#34;lines&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Size of the news file is about&#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">      <span class="nf">round</span><span class="p">(</span><span class="nf">object.size</span><span class="p">(</span><span class="n">news</span><span class="p">)</span><span class="o">/</span><span class="m">1024</span><span class="n">^2</span><span class="p">,</span> <span class="m">3</span><span class="p">),</span> <span class="s">&#34;MB&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Longest line has&#34;</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="nf">str_length</span><span class="p">(</span><span class="n">news</span><span class="p">)),</span> <span class="s">&#34;characters&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="corpus-creation">Corpus Creation</h3>
<p>We have three big data sets. I will take 1% random samples from each to create the corpus. This will provide enough coverage to explore data and build a prediction model.</p>
<p>I combine 1% samples of each data sets into one corpus.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">samples</span> <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">fraction</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">    <span class="n">output</span> <span class="o">&lt;-</span> <span class="nf">sample</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">fraction</span><span class="o">*</span><span class="nf">length</span><span class="p">(</span><span class="n">file</span><span class="p">),</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">blog_s</span> <span class="o">&lt;-</span> <span class="nf">samples</span><span class="p">(</span><span class="n">blog</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">news_s</span> <span class="o">&lt;-</span> <span class="nf">samples</span><span class="p">(</span><span class="n">news</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">twitter_s</span> <span class="o">&lt;-</span> <span class="nf">samples</span><span class="p">(</span><span class="n">twitter</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">corpus</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="n">blog_s</span><span class="p">,</span> <span class="n">news_s</span><span class="p">,</span> <span class="n">twitter_s</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="training-and-test-samples">Training and Test samples</h4>
<p>I will divide the 1% samples of each data sets into 80% for training and 20% test samples.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">train</span> <span class="o">&lt;-</span>  <span class="nf">c</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="n">blog_s</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="o">*</span><span class="nf">length</span><span class="p">(</span><span class="n">blog_s</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                  <span class="nf">sample</span><span class="p">(</span><span class="n">news_s</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="o">*</span><span class="nf">length</span><span class="p">(</span><span class="n">news_s</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">                  <span class="nf">sample</span><span class="p">(</span><span class="n">twitter_s</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="o">*</span><span class="nf">length</span><span class="p">(</span><span class="n">twitter_s</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">test</span> <span class="o">&lt;-</span> <span class="nf">setdiff</span><span class="p">(</span><span class="n">corpus</span><span class="p">,</span> <span class="n">train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">rm</span><span class="p">(</span><span class="n">blog_s</span><span class="p">,</span> <span class="n">news_s</span><span class="p">,</span><span class="n">twitter_s</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>Text Cleaning</strong></p>
<p>There are several factor we need to consider when cleaning/normalizing text data. And there are pros/cons about how much we clean the text data.</p>
<p>There are punctuation combining the words, replacing the letters, stopping the sentences and repetitions. In many applications you can observe any type of punctuation may be erased or some of them kept untouched.</p>
<p>Examples: &ldquo;I&rsquo;am&rdquo;, &ldquo;middle-class&rdquo;, &ldquo;stop!&rdquo;, &ldquo;what?&rdquo;, &ldquo;apple, banana&rdquo; etc.</p>
<ul>
<li>
<p>I chose to erase numbers, since they can be confusing and not predictable.</p>
</li>
<li>
<p>I transform all alphabetic characters to lowercase.</p>
</li>
<li>
<p>I erase unnecessary white-space.</p>
</li>
<li>
<p>Non-ASCII symbols are to be removed</p>
</li>
<li>
<p><strong>Stop-words</strong> are common words are dropped in most text-mining applications, because they have low information. But in this project we build a text prediction model and, I prefer to keep them for now.</p>
</li>
<li>
<p><strong>Stemming</strong> is another factor when processing text data before training model.</p>
</li>
<li>
<p>Profanity filter is another subject to consider. There are collections available to use but I prefer not to use at this time.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">train_df</span> <span class="o">&lt;-</span> <span class="nf">as_tibble</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">train_df</span><span class="o">$</span><span class="n">value</span> <span class="o">&lt;-</span> <span class="nf">str_replace_all</span><span class="p">(</span><span class="n">train_df</span><span class="o">$</span><span class="n">value</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;[:punct:]&#34;</span> <span class="o">=</span> <span class="s">&#34; &#34;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                        <span class="s">&#34;[0-9]&#34;</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;[:space:]+&#34;</span> <span class="o">=</span> <span class="s">&#34; &#34;</span><span class="p">))</span>
</span></span></code></pre></div><h3 id="tokenization">Tokenization</h3>
<p>For text mining purposes I will use functions from <code>tidytext</code> library. I transform sentences into one word in a row, then exclude missing values.</p>
<p>Then I can calculate frequencies of the words and sort them in descending order.</p>
<p><strong>One-Word</strong></p>
<p>Here I show most 20 frequently used words in a graph. Most frequent word is &ldquo;the&rdquo;.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">oneword</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl"><span class="n">train_df</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="n">word</span><span class="p">,</span> <span class="n">input</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">to_lower</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">drop_na</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">oneword[1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="n">]</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&#34;identity&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_text</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">),</span> <span class="n">vjust</span><span class="o">=</span><span class="m">1.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">2.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">(),</span> <span class="n">axis.ticks.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;20 Most Frequently Used Words&#34;</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Frequency&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;Words&#34;</span><span class="p">)</span> 
</span></span></code></pre></div><p><strong>Two-word Distribution</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">twoword</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl"><span class="n">train_df</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="n">word</span><span class="p">,</span> <span class="n">input</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="n">token</span> <span class="o">=</span> <span class="s">&#34;ngrams&#34;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="n">to_lower</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">drop_na</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">twoword[1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="n">]</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&#34;identity&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_text</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">),</span> <span class="n">vjust</span><span class="o">=</span><span class="m">1.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">2.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">(),</span> <span class="n">axis.ticks.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;20 Most Frequently Used Word Couples&#34;</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Frequency&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;Word Couples&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">90</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span>
</span></span></code></pre></div><p>Most frequent word couple is &ldquo;of the&rdquo;.</p>
<p><strong>Three-word Distribution</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">triword</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl"><span class="n">train_df</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="n">word</span><span class="p">,</span> <span class="n">input</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="n">token</span> <span class="o">=</span> <span class="s">&#34;ngrams&#34;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="n">to_lower</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">drop_na</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">triword[1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="n">]</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&#34;identity&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_text</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">),</span> <span class="n">vjust</span><span class="o">=</span><span class="m">1.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">3.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">(),</span> <span class="n">axis.ticks.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;20 Most Frequently Used Word Triplets&#34;</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Frequency&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;Word Triplets&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">90</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span>
</span></span></code></pre></div><p><strong>Four-word Distribution</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fourword</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl"><span class="n">train_df</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">unnest_tokens</span><span class="p">(</span><span class="n">output</span> <span class="o">=</span> <span class="n">word</span><span class="p">,</span> <span class="n">input</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="n">token</span> <span class="o">=</span> <span class="s">&#34;ngrams&#34;</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="n">to_lower</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">drop_na</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">count</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">fourword[1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="n">]</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">reorder</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&#34;identity&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_text</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">n</span><span class="p">),</span> <span class="n">vjust</span><span class="o">=</span><span class="m">1.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">3.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">(),</span> <span class="n">axis.ticks.y</span><span class="o">=</span><span class="nf">element_blank</span><span class="p">())</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;20 Most Frequently Used four-word phrases&#34;</span><span class="p">)</span> <span class="o">+</span> 
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">plot.title</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ylab</span><span class="p">(</span><span class="s">&#34;Frequency&#34;</span><span class="p">)</span> <span class="o">+</span> <span class="nf">xlab</span><span class="p">(</span><span class="s">&#34;four-word phrases&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span> <span class="o">=</span> <span class="m">90</span><span class="p">,</span> <span class="n">hjust</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">vjust</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">))</span>
</span></span></code></pre></div><p>So far, I have investigated the data making frequency tables to see what words are used more often together.</p>
<p>In the next steps I would like to start building the model to predict the next text based on the given word/words.</p>
<h3 id="word-coverage">Word Coverage</h3>
<p>How many unique words do you need in a frequency sorted dictionary to cover 50% of all word instances in the language? 90%?</p>
<p>Can you think of a way to increase the coverage &ndash; identifying words that may not be in the corpora or using a smaller number of words in the dictionary to cover the same number of phrases?</p>
<p>How Many of the top words are required to cover a given percentage of words present in the entire data-set?</p>
<p>We are going to answer this question by finding out how the number of words covered in the data-set increases as we add words from the most frequent to the least frequent:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">oneword_coverage</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">    <span class="n">oneword</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span><span class="n">coverage</span> <span class="o">=</span> <span class="nf">round</span><span class="p">(</span><span class="nf">cumsum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="m">100</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">           <span class="n">ranking</span> <span class="o">=</span> <span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">oneword</span><span class="p">))</span> 
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">oneword_coverage</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">oneword_coverage</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">ranking</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">coverage</span><span class="p">))</span> <span class="o">+</span> <span class="nf">geom_line</span><span class="p">(</span><span class="n">stat</span> <span class="o">=</span> <span class="s">&#34;identity&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">min50</span> <span class="o">&lt;-</span> <span class="nf">min</span><span class="p">(</span><span class="n">oneword_coverage[oneword_coverage</span><span class="o">$</span><span class="n">coverage</span> <span class="o">&gt;</span> <span class="m">50</span><span class="p">,</span> <span class="n">]</span><span class="o">$</span><span class="n">ranking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">min90</span> <span class="o">&lt;-</span> <span class="nf">min</span><span class="p">(</span><span class="n">oneword_coverage[oneword_coverage</span><span class="o">$</span><span class="n">coverage</span> <span class="o">&gt;</span> <span class="m">90</span><span class="p">,</span> <span class="n">]</span><span class="o">$</span><span class="n">ranking</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Minimum number of top words for 50% coverage is&#34;</span><span class="p">,</span> <span class="n">min50</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">paste</span><span class="p">(</span><span class="s">&#34;Minimum number of top words for 90% coverage is&#34;</span><span class="p">,</span> <span class="n">min90</span><span class="p">)</span>
</span></span></code></pre></div><h3 id="model-setup">Model Setup</h3>
<p>as.character</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">sbo</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">&lt;-</span> <span class="nf">sbo_predictor</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">corpus</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">                   <span class="n">N</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span> <span class="c1"># Train a 3-gram model</span>
</span></span><span class="line"><span class="cl">                   <span class="n">dict</span> <span class="o">=</span> <span class="n">target</span> <span class="o">~</span> <span class="m">0.75</span><span class="p">,</span> <span class="c1"># cover 75% of training corpus</span>
</span></span><span class="line"><span class="cl">                   <span class="n">.preprocess</span> <span class="o">=</span> <span class="n">preprocess</span><span class="p">,</span> <span class="c1"># Pre-processing transformation </span>
</span></span><span class="line"><span class="cl">                   <span class="n">EOS</span> <span class="o">=</span> <span class="s">&#34;.?!:;&#34;</span><span class="p">,</span> <span class="c1"># End-Of-Sentence tokens</span>
</span></span><span class="line"><span class="cl">                   <span class="n">lambda</span> <span class="o">=</span> <span class="m">0.4</span><span class="p">,</span> <span class="c1"># Back-off penalization in SBO algorithm</span>
</span></span><span class="line"><span class="cl">                   <span class="n">L</span> <span class="o">=</span> <span class="m">5L</span><span class="p">,</span> <span class="c1"># Number of predictions for input</span>
</span></span><span class="line"><span class="cl">                   <span class="n">filtered</span> <span class="o">=</span> <span class="s">&#34;&lt;UNK&gt;&#34;</span> <span class="c1"># Exclude the &lt;UNK&gt; token from predictions</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">predict</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s">&#34;Exclude the&#34;</span><span class="p">)</span>
</span></span></code></pre></div>
    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/llm/">LLM</a>
  
</div>



<div class="share-box">
  <ul class="share">
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fdavutemrah.github.io%2Fpost%2F2020-02-04-nextword%2Fnextword_2022_02_04%2F&amp;text=Next&#43;Word&#43;Prediction" target="_blank" rel="noopener" class="share-btn-twitter" aria-label="twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fdavutemrah.github.io%2Fpost%2F2020-02-04-nextword%2Fnextword_2022_02_04%2F&amp;t=Next&#43;Word&#43;Prediction" target="_blank" rel="noopener" class="share-btn-facebook" aria-label="facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
        
      
      <li>
        <a href="mailto:?subject=Next%20Word%20Prediction&amp;body=https%3A%2F%2Fdavutemrah.github.io%2Fpost%2F2020-02-04-nextword%2Fnextword_2022_02_04%2F" target="_blank" rel="noopener" class="share-btn-email" aria-label="envelope">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fdavutemrah.github.io%2Fpost%2F2020-02-04-nextword%2Fnextword_2022_02_04%2F&amp;title=Next&#43;Word&#43;Prediction" target="_blank" rel="noopener" class="share-btn-linkedin" aria-label="linkedin-in">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="whatsapp://send?text=Next&#43;Word&#43;Prediction%20https%3A%2F%2Fdavutemrah.github.io%2Fpost%2F2020-02-04-nextword%2Fnextword_2022_02_04%2F" target="_blank" rel="noopener" class="share-btn-whatsapp" aria-label="whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Fdavutemrah.github.io%2Fpost%2F2020-02-04-nextword%2Fnextword_2022_02_04%2F&amp;title=Next&#43;Word&#43;Prediction" target="_blank" rel="noopener" class="share-btn-weibo" aria-label="weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://davutemrah.github.io/"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu47c85d2f20af5df69c32697081a29e40_26761_270x270_fill_q75_lanczos_center.jpeg" alt="Davut Ayan"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://davutemrah.github.io/">Davut Ayan</a></h5>
      <h6 class="card-subtitle">Marketing Data Scientist</h6>
      <p class="card-text">I am an experienced data scientist expert in Machine Learning, causal inference and soccer.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?hl=en&amp;user=9dLXmacAAAAJ" target="_blank" rel="noopener">
        <i class="fas fa-graduation-cap"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/davutemrah" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/davutayan/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://medium.com/@demrahayan" target="_blank" rel="noopener">
        <i class="fab fa-medium"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  


<p class="powered-by">
  
  <a href="/privacy/">Privacy Policy</a>
  
  
   &middot; 
  <a href="/terms/">Terms of Use</a>
  
</p>












  
  
  

  
  
    
  
  
    
  

  

  
  <p class="powered-by copyright-license-text">
    © 2024 Davut Ayan. This work is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank">CC BY NC ND 4.0</a>
  </p>
  

  <p class="powered-by footer-license-icons">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0" rel="noopener noreferrer" target="_blank" aria-label="Creative Commons">
      <i class="fab fa-creative-commons fa-2x" aria-hidden="true"></i>
      <i class="fab fa-creative-commons-by fa-2x" aria-hidden="true"></i>
      
        <i class="fab fa-creative-commons-nc fa-2x" aria-hidden="true"></i>
      
      
        <i class="fab fa-creative-commons-nd fa-2x" aria-hidden="true"></i>
      
    </a>
  </p>





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Hugo Blox Builder</a> — the free, <a href="https://github.com/HugoBlox/hugo-blox-builder" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js"></script>




  

  
  

  






  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js" integrity="" crossorigin="anonymous"></script>








  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  












  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>









  
  


<script src="/en/js/wowchemy.min.62586ca65ca61821fe707eb9fa6268b7.js"></script>



  <script src="/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js" type="module"></script>




  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.9137013a66774049159934c29c3f0205.js" type="module"></script>


















</body>
</html>
